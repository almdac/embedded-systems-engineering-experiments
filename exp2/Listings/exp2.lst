C51 COMPILER V9.59.0.0   EXP2                                                              03/10/2019 18:03:36 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE EXP2
OBJECT MODULE PLACED IN .\Objects\exp2.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE exp2.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\exp2
                    -.lst) TABS(2) OBJECT(.\Objects\exp2.obj)

line level    source

   1          #include <REG51F.H>
   2          
   3          sbit cl = P2^0;
   4          sbit ch = P2^1;
   5          
   6          int first_state = 2, second_state = 2, old_ch, old_cl, first_counter = 0, second_counter = 0;
   7          
   8          int chDown();
   9          int clDown();
  10          int chUp();
  11          int clUp();
  12          int firstTimeout();
  13          int secondTimeout();
  14          
  15          void firstMachine();
  16          void secondMachine();
  17          
  18          void main() {
  19   1        old_ch = ch;
  20   1        old_cl = cl;
  21   1        while(1) {
  22   2          firstMachine();
  23   2          secondMachine();
  24   2        }
  25   1      }
  26          
  27          int chDown() {
  28   1        if (old_ch && !ch) {
  29   2          old_ch = ch;
  30   2          return 1;
  31   2        } else return 0;
  32   1      }
  33          
  34          int clDown() {
  35   1        if (old_cl && !cl) {
  36   2          old_cl = cl;
  37   2          return 1;
  38   2        } else return 0;
  39   1      }
  40          
  41          int chUp() {
  42   1        if (!old_ch && ch) {
  43   2          old_ch = ch;
  44   2          return 1;
  45   2        } else return 0;
  46   1      }
  47          
  48          int clUp() {
  49   1        if (!old_cl && cl) {
  50   2          old_cl = cl;
  51   2          return 1;
  52   2        } else return 0;
  53   1      }
  54          
C51 COMPILER V9.59.0.0   EXP2                                                              03/10/2019 18:03:36 PAGE 2   

  55          int firstTimeout() {
  56   1        if (first_counter == 25000) {
  57   2          first_counter = 0;
  58   2          return 1;
  59   2        }
  60   1        first_counter++;
  61   1        return 0;
  62   1      }
  63          
  64          int secondTimeout() {
  65   1        if (second_counter == 25000) {
  66   2          second_counter = 0;
  67   2          return 1;
  68   2        }
  69   1        second_counter++;
  70   1        return 0;
  71   1      }
  72          
  73          void firstMachine(){
  74   1        switch (first_state) {
  75   2          case 0:
  76   2            if (chUp()) {
  77   3              P1 = (P1 & 0x0F) | (P0 & 0xF0);
  78   3              first_state = 2;
  79   3            } else if (chDown()) {
  80   3              first_state = 1;
  81   3            }
  82   2            break;
  83   2          case 1:
  84   2            if (chUp()) {
  85   3              P1 = (P1 & 0x0F) | (P0 & 0xF0);
  86   3              first_state = 2;
  87   3            }
  88   2            break;  
  89   2          case 2:
  90   2            if (firstTimeout()) {
  91   3              P1 = P1 & 0x0F;
  92   3              first_state = 0;
  93   3            }
  94   2            break;
  95   2        }
  96   1      }
  97          
  98          void secondMachine() {
  99   1          switch (second_state) {
 100   2          case 0:
 101   2            if (clUp()) {
 102   3              P1 = (P1 & 0xF0) | (P0 & 0x0F);
 103   3              second_state = 2;
 104   3            } else if (clDown()) {
 105   3              second_state = 1;
 106   3            }
 107   2            break;
 108   2          case 1:
 109   2            if (clUp()) {
 110   3              P1 = (P1 & 0xF0) | (P0 & 0x0F);
 111   3              second_state = 2;
 112   3            }
 113   2            break;
 114   2          case 2:
 115   2            if (secondTimeout()) {
 116   3              P1 = P1 & 0xF0;
C51 COMPILER V9.59.0.0   EXP2                                                              03/10/2019 18:03:36 PAGE 3   

 117   3              first_state = 0;
 118   3            }
 119   2            break;
 120   2        }
 121   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    356    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     12    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
